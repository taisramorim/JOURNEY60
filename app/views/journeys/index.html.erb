<div class="container my-5">
  <div>
    <h1>Welcome!</h1>
    <h3 class="text-center">Here are your daily challenges.</h3>
  </div>
</div>

<div class="container">
  <div class="row">
    <% @journeys.each do |journey| %>
      <div class="modal fade" id="journeyModal" tabindex="-1" aria-labelledby="exampleModalJourney" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
          <div class="modal-content" style="padding: 20px;">
            <div class="modal-header text-center">
              <h4 class="modal-title" id="exampleModalJourney"><strong>Daily Challenges</strong></h4>
              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>

            <div class="modal-body text-center">
              <h2 class="mb-4">Let's go!</h2>
              <%= journey.title %>
              <div class="challenges" data-controller="challenges">
                <% journey.challenges.each do |challenge| %>
                <div class="challenge">
                  <%= render partial: 'challenges/challenge', locals: { journey: journey, challenge: challenge } %>
                </div>
                <% end %>
                <div>
                  <% completed = journey.challenges.select { |challenge| challenge.completed == true } %>
                  <% if journey.challenges.length == completed.length%>
                    <%= link_to 'Reward', reward_path(3), class: 'reward-btn btn btn-info mt-4' %>
                  <% end %>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="col-6 col-md-4 col-lg-2">
        <div class="journey-card">
          <div class="journey-card-inner">
            <div class="journey-card-front">
              <img class='journey-image' src="https://res.cloudinary.com/dxrwfnroj/image/upload/v1701435551/logo_gpm6ug.png" >
              <div class="journey-card-title">
                <%= journey.title %>
              </div>
            </div>
            <div class="journey-card-back">
              <%= link_to "Bora!", journey_path(181) %>
              <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#journeyModal">
                Launch Journey modal
              </button>
              <div class="journey-details">
                <h3>Today's challenges!</h3>
                <div class="journey-challenges">
                  <%# journey.challenges.each do |challenge| %>
                  <%# challenge.description %>
                  <%# end %>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    <% end %>
  </div>
</div>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    var cards = document.querySelectorAll(".journey-card");

    cards.forEach(function (card) {
      card.addEventListener("click", function () {
        card.classList.toggle("is-flipped");
      });
    });
  });
</script>
